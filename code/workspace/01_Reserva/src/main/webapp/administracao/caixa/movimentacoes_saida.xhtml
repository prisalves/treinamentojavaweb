<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pm="http://primefaces.org/mobile"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:sec="http://www.springframework.org/security/tags"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
	xmlns:sp="http://www.springframework.org/tags"
	template="/template/template.xhtml">

	<ui:define name="title">        
            MOVIMENTAÇÕES SAÍDA DO CAIXA      
    </ui:define>

	<!-- <ui:define name="header" /> -->
	<!-- <ui:define name="slide" /> -->
	<!-- <ui:define name="search" /> -->
	<!-- <ui:define name="modal" /> -->
	<!-- <ui:define name="menuLeft" /> -->
	<!-- <ui:define name="menuRight" /> -->

	<ui:define name="main">

		<ol class="breadcrumb">
			<li ><a href="#{request.contextPath}/">Página inicial</a></li>
			<li ><a href="#{request.contextPath}/caixas">Caixas</a></li>
			<li class="active"><a href="#{request.contextPath}/movimentacoes_saida">Movimentações saída</a></li>
			<!-- <li ><a href="#{request.contextPath}/movimentacoes_entrada">Movimentações entrada</a></li> -->
		</ol>
		<!-- //breadcrumb-->

		<div id="content">
		
		<ui:remove>
		<!-- 
		<p:panelGrid columns="2" style="width:100%;">            
		    <h:panelGroup>
			    <h:form id="filtro" style="text-align:center;">
				<p:messages id="messagesFiltro" globalOnly="false" autoUpdate="false" showDetail="false" closable="true"
					showIcon="false" showSummary="true" />
					
				<h:outputLabel value="Filtro apartamentos" styleClass="control-label" />
				<b:selectMultiMenu allSelectedText="Todos"
					includeSelectAllOption="true" nonSelectedText="Selecione" numberDisplayed="1"
					selectAllText="Selecionar todos" size="10" nSelectedText="selecionados" buttonWidth="130"
					enableCaseInsensitiveFiltering="true" enableFiltering="true" radiobuttons="true"
					filterPlaceholder="Procurar" value="#{movimentacaoService.filtroApartamentos}">
					<f:selectItems value="#{apartamentoService.findAll().toArray()}" var="select"
						itemLabel="#{select}" itemValue="#{select.identificador}" />
				</b:selectMultiMenu>
				
				<p:commandButton value="filtrar" icon="fa fa-thumbs-up"
						action="#{movimentacaoService.atualizaTable}" update="messagesFiltro"
						styleClass="noui zoom btn btn-primary btn-sm" />
			</h:form>
		    </h:panelGroup>
		    <h:panelGroup>
		    <h:form id="botoes" style="text-align:center;">
					
					<ui:remove>
					<p:commandLink styleClass="zoom btn btn-success btn-lg" style="margin:10px;" action="#{movimentacaoService.entrada}">
						<b:iconAwesome name="download" size="3x" />
						<br/>ENTRADA
					</p:commandLink>
					</ui:remove>
					
					<p:commandLink
					rendered="#{caixaService.caixa.dataCaixa!=null}" 
					styleClass="zoom btn btn-danger btn-lg" style="margin:10px;" action="#{movimentacaoService.saida}">
						<b:iconAwesome name="external-link-square" size="2x" />
						<br/>Saída do caixa
						<br/> #{caixaService.caixa}
					</p:commandLink>
					
			</h:form>
		    </h:panelGroup>
		</p:panelGrid>
		 -->
		</ui:remove>
		
			<h:form id="formDataTable">
			
			<p:commandLink
					rendered="#{caixaService.caixa.dataCaixa!=null}" 
					styleClass="zoom btn btn-danger btn-lg" style="margin:10px;" action="#{movimentacaoService.saida}">
						<b:iconAwesome name="external-link-square" size="2x" />
						<br/>Efetuar saída do 
						<br/>caixa #{caixaService.caixa}
					</p:commandLink>
					
				<p:dataTable id="dataTable" value="#{movimentacaoService.lista}" style="margin-top:10px;"
					var="item" paginator="true" rows="10" widgetVar="tableMovimentacao"
					paginatorPosition="bottom" styleClass="table-danger" 
					paginatorTemplate="{CurrentPageReport} {RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
					rowsPerPageTemplate="10,20,50,100,500"
					currentPageReportTemplate="Mostrando de {startRecord} até {endRecord} de {totalRecords} registros"
					filteredValue="#{movimentacaoService.filtered}"
					emptyMessage="Nenhum registro encontrado!" >

						<f:facet name="header">
							<h:outputText value="Movimentações de caixa do usuário: #{usuarioSistemaService.usernameSistema}" />
						</f:facet>
	
						<p:column headerText="CAIXA" style="text-align:center;" sortBy="#{item.caixa.dataCaixa}">
							<h:outputText value="#{item.caixa.operador} - #{facesUtil.converteData(item.caixa.dataCaixa,null)}" />
						</p:column>
						
						<p:column headerText="DESCR" style="text-align:center;" >
							<h:outputText pt:data-toggle="tooltip" pt:data-placement="top" pt:title="#{item.descricao}" value="#{facesUtil.substring(item.descricao,20)}" />
						</p:column>
						
						<p:column headerText="APARTAMENTOS" style="text-align:center;" >
							<h:outputText pt:data-toggle="tooltip" pt:data-placement="top" pt:title="#{item.apartamentos}" value="#{facesUtil.substring(item.apartamentos,20)}" />
						</p:column>
						
						<p:column headerText="VALOR" style="text-align:center;" sortBy="#{item.valor}" >
							<h:outputText value="#{item.valor}">
								<f:convertNumber pattern="R$ #,##0.00" />
							</h:outputText>
						</p:column>
						
						<f:facet name="footer">
					        <h:outputText value="Total:" />
					        <h:outputText value="#{movimentacaoService.total}">
				                    <f:convertNumber pattern="R$ #,##0.00" />
				            </h:outputText>
					    </f:facet>
						
	
					</p:dataTable>
			        
			</h:form>
			
			<ui:remove>
			<!-- 
			<h:panelGroup id="movimentacaoBlock">
				<h:form id="formEntrada" rendered="#{movimentacaoService.tipoMovimentacao.equals('Entrada')}">
					Entrada ok
				</h:form>
				<h:form id="formSaida" rendered="#{movimentacaoService.tipoMovimentacao.equals('Saida')}">
					saida ok
				</h:form>
			</h:panelGroup>
			-->
			</ui:remove>
			

		</div>
		
		<ui:include src="modalSaida.xhtml" />

	</ui:define>

	<ui:define name="script">
	
		<script type="text/javascript">

				var body=$("body");
					body.toggleClass("in");
				
	</script>
	
	</ui:define>

</ui:composition>